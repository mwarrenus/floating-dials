#!/bin/sh

app="floating-dials"
MAJOR="1"
MINOR="0"

config="src/config.h" # $app.c: #include "config.h"

for f in "main" "test" "rockshot"
do
    echo "// generated by make-all -- do not edit" > "$config"
    echo "#define MAJOR $MAJOR" >> "$config"
    echo "#define MINOR $MINOR" >> "$config"
    echo "#define VERSION \"$MAJOR.$MINOR\"" >> "$config"
    case "$f" in
	"main")
	    ;;
	"test")
	    echo "#define TEST" >> "$config"
	    ;;
	"rockshot")
	    echo "#define ROCKSHOT true" >> "$config"
	    ;;
    esac
    ./waf configure && ./waf build && mv "build/$app.pbw" "build/$app-$f-$MAJOR.$MINOR.pbw"
done
